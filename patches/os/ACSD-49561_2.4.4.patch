diff --git a/vendor/magento/module-elasticsearch/SearchAdapter/Query/Builder/Sort.php b/vendor/magento/module-elasticsearch/SearchAdapter/Query/Builder/Sort.php
index e8085787f2b..869a350aae7 100644
--- a/vendor/magento/module-elasticsearch/SearchAdapter/Query/Builder/Sort.php
+++ b/vendor/magento/module-elasticsearch/SearchAdapter/Query/Builder/Sort.php
@@ -89,7 +89,7 @@ class Sort
             if (in_array($item['field'], $this->skippedFields)) {
                 continue;
             }
-            $attribute = $this->attributeAdapterProvider->getByAttributeCode($item['field']);
+            $attribute = $this->attributeAdapterProvider->getByAttributeCode((string)$item['field']);
             $fieldName = $this->fieldNameResolver->getFieldName($attribute);
             if (isset($this->map[$fieldName])) {
                 $fieldName = $this->map[$fieldName];
diff --git a/vendor/magento/module-product-alert/Model/Mailing/AlertProcessor.php b/vendor/magento/module-product-alert/Model/Mailing/AlertProcessor.php
index 105fb6ac372..988e5e91e1e 100644
--- a/vendor/magento/module-product-alert/Model/Mailing/AlertProcessor.php
+++ b/vendor/magento/module-product-alert/Model/Mailing/AlertProcessor.php
@@ -155,6 +155,7 @@ class AlertProcessor
      * @param int $websiteId
      * @return array
      * @throws \Exception
+     * @SuppressWarnings(PHPMD.CyclomaticComplexity)
      */
     private function processAlerts(string $alertType, array $customerIds, int $websiteId): array
     {
@@ -182,6 +183,7 @@ class AlertProcessor
         /** @var Website $website */
         $website = $this->storeManager->getWebsite($websiteId);
         $defaultStoreId = $website->getDefaultStore()->getId();
+        $products = [];
 
         /** @var Price|Stock $alert */
         foreach ($collection as $alert) {
@@ -196,7 +198,12 @@ class AlertProcessor
                     $customer = $this->customerRepository->getById($alert->getCustomerId());
                 }
 
-                $product = $this->productRepository->getById($alert->getProductId(), false, $defaultStoreId);
+                if (!isset($products[$alert->getProductId()])) {
+                    $product = $this->productRepository->getById($alert->getProductId(), false, $defaultStoreId, true);
+                    $products[$alert->getProductId()] = $product;
+                } else {
+                    $product = $products[$alert->getProductId()];
+                }
 
                 switch ($alertType) {
                     case self::ALERT_TYPE_STOCK:
diff --git a/vendor/magento/module-store/Model/App/Emulation.php b/vendor/magento/module-store/Model/App/Emulation.php
index fe9df22c243..f8d15ae2124 100644
--- a/vendor/magento/module-store/Model/App/Emulation.php
+++ b/vendor/magento/module-store/Model/App/Emulation.php
@@ -9,33 +9,44 @@
  */
 namespace Magento\Store\Model\App;
 
+use Magento\Framework\App\Config\ScopeConfigInterface;
+use Magento\Framework\App\ObjectManager;
+use Magento\Framework\Locale\ResolverInterface;
+use Magento\Framework\Phrase;
+use Magento\Framework\Phrase\RendererInterface;
 use Magento\Framework\Translate\Inline\ConfigInterface;
+use Magento\Framework\Translate\Inline\StateInterface;
+use Magento\Framework\TranslateInterface;
+use Magento\Framework\View\DesignInterface;
+use Magento\Store\Model\StoreManagerInterface;
+use Psr\Log\LoggerInterface;
 
 /**
  * @api
  * @since 100.0.2
+ * @SuppressWarnings(PHPMD.CouplingBetweenObjects)
  */
 class Emulation extends \Magento\Framework\DataObject
 {
     /**
-     * @var \Magento\Store\Model\StoreManagerInterface
+     * @var StoreManagerInterface
      */
     protected $_storeManager;
 
     /**
-     * @var \Magento\Framework\TranslateInterface
+     * @var TranslateInterface
      */
     protected $_translate;
 
     /**
      * Core store config
      *
-     * @var \Magento\Framework\App\Config\ScopeConfigInterface
+     * @var ScopeConfigInterface
      */
     protected $_scopeConfig;
 
     /**
-     * @var \Magento\Framework\Locale\ResolverInterface
+     * @var ResolverInterface
      */
     protected $_localeResolver;
 
@@ -50,7 +61,7 @@ class Emulation extends \Magento\Framework\DataObject
     protected $inlineConfig;
 
     /**
-     * @var \Magento\Framework\Translate\Inline\StateInterface
+     * @var StateInterface
      */
     protected $inlineTranslation;
 
@@ -62,39 +73,46 @@ class Emulation extends \Magento\Framework\DataObject
     private $initialEnvironmentInfo;
 
     /**
-     * @var \Psr\Log\LoggerInterface
+     * @var LoggerInterface
      */
     private $logger;
 
     /**
-     * @var \Magento\Framework\View\DesignInterface
+     * @var DesignInterface
      */
     private $_viewDesign;
 
     /**
-     * @param \Magento\Store\Model\StoreManagerInterface $storeManager
-     * @param \Magento\Framework\View\DesignInterface $viewDesign
+     * @var RendererInterface
+     */
+    private $phraseRenderer;
+
+    /**
+     * @param StoreManagerInterface $storeManager
+     * @param DesignInterface $viewDesign
      * @param \Magento\Framework\App\DesignInterface $design
-     * @param \Magento\Framework\TranslateInterface $translate
-     * @param \Magento\Framework\App\Config\ScopeConfigInterface $scopeConfig
+     * @param TranslateInterface $translate
+     * @param ScopeConfigInterface $scopeConfig
      * @param ConfigInterface $inlineConfig
-     * @param \Magento\Framework\Translate\Inline\StateInterface $inlineTranslation
-     * @param \Magento\Framework\Locale\ResolverInterface $localeResolver
-     * @param \Psr\Log\LoggerInterface $logger
+     * @param StateInterface $inlineTranslation
+     * @param ResolverInterface $localeResolver
+     * @param LoggerInterface $logger
      * @param array $data
+     * @param RendererInterface|null $phraseRenderer
      * @SuppressWarnings(PHPMD.ExcessiveParameterList)
      */
     public function __construct(
-        \Magento\Store\Model\StoreManagerInterface $storeManager,
-        \Magento\Framework\View\DesignInterface $viewDesign,
+        StoreManagerInterface $storeManager,
+        DesignInterface $viewDesign,
         \Magento\Framework\App\DesignInterface $design,
-        \Magento\Framework\TranslateInterface $translate,
-        \Magento\Framework\App\Config\ScopeConfigInterface $scopeConfig,
+        TranslateInterface $translate,
+        ScopeConfigInterface $scopeConfig,
         ConfigInterface $inlineConfig,
-        \Magento\Framework\Translate\Inline\StateInterface $inlineTranslation,
-        \Magento\Framework\Locale\ResolverInterface $localeResolver,
-        \Psr\Log\LoggerInterface $logger,
-        array $data = []
+        StateInterface $inlineTranslation,
+        ResolverInterface $localeResolver,
+        LoggerInterface $logger,
+        array $data = [],
+        ?RendererInterface $phraseRenderer = null
     ) {
         $this->_localeResolver = $localeResolver;
         parent::__construct($data);
@@ -106,6 +124,8 @@ class Emulation extends \Magento\Framework\DataObject
         $this->inlineConfig = $inlineConfig;
         $this->inlineTranslation = $inlineTranslation;
         $this->logger = $logger;
+        $this->phraseRenderer = $phraseRenderer
+            ?? ObjectManager::getInstance()->get(RendererInterface::class);
     }
 
     /**
@@ -129,7 +149,9 @@ class Emulation extends \Magento\Framework\DataObject
             return;
         }
 
-        if ($storeId == $this->_storeManager->getStore()->getStoreId() && !$force) {
+        if (!$force
+            && ($storeId == $this->_storeManager->getStore()->getId() && $this->_viewDesign->getArea() === $area)
+        ) {
             return;
         }
         $this->storeCurrentEnvironmentInfo();
@@ -160,8 +182,7 @@ class Emulation extends \Magento\Framework\DataObject
         $this->_localeResolver->setLocale($newLocaleCode);
         $this->_translate->setLocale($newLocaleCode);
         $this->_translate->loadData($area);
-
-        return;
+        Phrase::setRenderer($this->phraseRenderer);
     }
 
     /**
@@ -183,7 +204,7 @@ class Emulation extends \Magento\Framework\DataObject
         // Current store needs to be changed right before locale change and after design change
         $this->_storeManager->setCurrentStore($initialDesign['store']);
         $this->_restoreInitialLocale($this->initialEnvironmentInfo->getInitialLocaleCode(), $initialDesign['area']);
-
+        Phrase::setRenderer($this->initialEnvironmentInfo->getPhraseRenderer());
         $this->initialEnvironmentInfo = null;
         return $this;
     }
@@ -206,6 +227,8 @@ class Emulation extends \Magento\Framework\DataObject
             ]
         )->setInitialLocaleCode(
             $this->_localeResolver->getLocale()
+        )->setPhraseRenderer(
+            Phrase::getRenderer()
         );
     }
 
diff --git a/vendor/magento/framework-amqp/Config.php b/vendor/magento/framework-amqp/Config.php
index 44e033f4a7b..3769ed51f73 100644
--- a/vendor/magento/framework-amqp/Config.php
+++ b/vendor/magento/framework-amqp/Config.php
@@ -23,20 +23,20 @@ class Config
     /**
      * Queue config key
      */
-    const QUEUE_CONFIG = 'queue';
+    public const QUEUE_CONFIG = 'queue';
 
     /**
      * Amqp config key
      */
-    const AMQP_CONFIG = 'amqp';
+    public const AMQP_CONFIG = 'amqp';
 
-    const HOST = 'host';
-    const PORT = 'port';
-    const USERNAME = 'user';
-    const PASSWORD = 'password';
-    const VIRTUALHOST = 'virtualhost';
-    const SSL = 'ssl';
-    const SSL_OPTIONS = 'ssl_options';
+    public const HOST = 'host';
+    public const PORT = 'port';
+    public const USERNAME = 'user';
+    public const PASSWORD = 'password';
+    public const VIRTUALHOST = 'virtualhost';
+    public const SSL = 'ssl';
+    public const SSL_OPTIONS = 'ssl_options';
 
     /**
      * Deployment configuration
@@ -140,7 +140,7 @@ class Config
      */
     private function createConnection(): AbstractConnection
     {
-        $sslEnabled = trim($this->getValue(self::SSL)) === 'true';
+        $sslEnabled = $this->getValue(self::SSL) && trim($this->getValue(self::SSL)) === 'true';
         $options = new FactoryOptions();
         $options->setHost($this->getValue(self::HOST));
         $options->setPort($this->getValue(self::PORT));
diff --git a/vendor/magento/framework/DataObject.php b/vendor/magento/framework/DataObject.php
index d74b477d41f..99ccaacdad3 100644
--- a/vendor/magento/framework/DataObject.php
+++ b/vendor/magento/framework/DataObject.php
@@ -120,6 +120,7 @@ class DataObject implements \ArrayAccess
      * @param string $key
      * @param string|int $index
      * @return mixed
+     * @SuppressWarnings(PHPMD.CyclomaticComplexity)
      */
     public function getData($key = '', $index = null)
     {
@@ -128,7 +129,7 @@ class DataObject implements \ArrayAccess
         }
 
         /* process a/b/c key as ['a']['b']['c'] */
-        if (strpos($key, '/') !== false) {
+        if ($key !== null && strpos($key, '/') !== false) {
             $data = $this->getDataByPath($key);
         } else {
             $data = $this->_getData($key);
diff --git a/vendor/magento/framework/Filter/Input/MaliciousCode.php b/vendor/magento/framework/Filter/Input/MaliciousCode.php
index 7048d85be3c..a6fa7d69c62 100644
--- a/vendor/magento/framework/Filter/Input/MaliciousCode.php
+++ b/vendor/magento/framework/Filter/Input/MaliciousCode.php
@@ -47,7 +47,7 @@ class MaliciousCode implements \Zend_Filter_Interface
     {
         $replaced = 0;
         do {
-            $value = preg_replace($this->_expressions, '', $value, -1, $replaced);
+            $value = preg_replace($this->_expressions, '', $value ?? '', -1, $replaced);
         } while ($replaced !== 0);
         return  $value;
     }
diff --git a/vendor/magento/framework/Search/Request/Binder.php b/vendor/magento/framework/Search/Request/Binder.php
index 5016c1c1192..89ae502e629 100644
--- a/vendor/magento/framework/Search/Request/Binder.php
+++ b/vendor/magento/framework/Search/Request/Binder.php
@@ -82,7 +82,7 @@ class Binder
     private function processData($data, $bindData)
     {
         array_walk_recursive($bindData, function (&$item) {
-            $item = trim($item);
+            $item = $item !== null ? trim($item) : '';
         });
         $bindData = array_filter($bindData, function ($element) {
             return is_array($element) ? count($element) : strlen($element);
